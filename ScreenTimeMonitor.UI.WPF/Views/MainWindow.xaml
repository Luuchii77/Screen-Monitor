<Window x:Class="ScreenTimeMonitor.UI.WPF.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="Screen Time Monitor" Height="600" Width="900" Background="#0F1419" Foreground="#E8EAED">
    <Window.Resources>
        <!-- TabControl and TabItem Styles -->
        <Style TargetType="TabControl">
            <Setter Property="Background" Value="#0F1419"/>
            <Setter Property="Foreground" Value="#E8EAED"/>
        </Style>
        
        <Style TargetType="TabItem">
            <Setter Property="Background" Value="#1A2A3A"/>
            <Setter Property="Foreground" Value="#E8EAED"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border Name="Border" BorderBrush="#00D9FF" BorderThickness="0,0,0,2" Background="#1A2A3A" Padding="10,5">
                            <ContentPresenter x:Name="ContentSite" ContentSource="Header" TextBlock.Foreground="#E8EAED"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#2A4A5A"/>
                                <Setter TargetName="Border" Property="BorderBrush" Value="#00D9FF"/>
                                <Setter Property="Foreground" Value="#00D9FF"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#2A3A4A"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- DatePicker Styling -->
        <Style TargetType="DatePicker">
            <Setter Property="Background" Value="#2A4A5A"/>
            <Setter Property="Foreground" Value="#E8EAED"/>
            <Setter Property="BorderBrush" Value="#00D9FF"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8"/>
        </Style>
        
        <!-- ComboBox Styling -->
        <Style TargetType="ComboBox">
            <Setter Property="Background" Value="#2A4A5A"/>
            <Setter Property="Foreground" Value="#FFFFFF"/>
            <Setter Property="BorderBrush" Value="#00D9FF"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>
        
        <!-- ComboBoxItem Styling -->
        <Style TargetType="ComboBoxItem">
            <Setter Property="Foreground" Value="#FFFFFF"/>
            <Setter Property="Background" Value="#1A2A3A"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="FontSize" Value="12"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#00D9FF"/>
                    <Setter Property="Foreground" Value="#0F1419"/>
                    <Setter Property="FontWeight" Value="Bold"/>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#2A5A7A"/>
                    <Setter Property="Foreground" Value="#FFFFFF"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- Hover button style -->
        <Style x:Key="HoverButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#00D9FF"/>
            <Setter Property="Foreground" Value="#0F1419"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#00F0FF"/>
                                <Setter Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect ShadowDepth="3" BlurRadius="6" Color="#00D9FF" Opacity="0.4"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#00B8D4"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- DataGrid row hover effect - selection hidden with transparent background -->
        <Style x:Key="DataGridRowStyle" TargetType="DataGridRow">
            <Setter Property="Background" Value="#1A2A3A"/>
            <Setter Property="Foreground" Value="#E8EAED"/>
            <Setter Property="Padding" Value="5"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#2A4A5A"/>
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="Foreground" Value="#E8EAED"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#1A2A3A" Padding="15" BorderBrush="#00D9FF" BorderThickness="0,0,0,1">
            <StackPanel>
                <TextBlock Text="Screen Time Monitor" Foreground="#00D9FF" FontSize="24" FontWeight="Bold"/>
                <TextBlock Name="StatusTextBlock" Text="Disconnected" Foreground="#A0A0A0" FontSize="12" Margin="0,5,0,0"/>
            </StackPanel>
        </Border>

        <!-- Tab Control -->
        <TabControl Grid.Row="1" Margin="10">
            <!-- Live Activity Tab -->
            <TabItem Header="Live Activity" Padding="10,5" Foreground="#E8EAED">
                <Grid Background="#0F1419">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="0,0,0,1" Padding="15">
                        <StackPanel Orientation="Horizontal" Margin="0" VerticalAlignment="Center">
                            <Button Name="ConnectButton" Content="ðŸ”Œ Connect to Service" Width="160" Margin="0,0,10,0" Click="ConnectButton_Click" 
                                    Background="#00D9FF" Foreground="#0F1419" Padding="10,8" FontWeight="Bold" Cursor="Hand" Style="{StaticResource HoverButtonStyle}"/>
                            <Button Name="DisconnectButton" Content="ðŸ”Œ Disconnect" Width="140" Margin="0,0,15,0" Click="DisconnectButton_Click" 
                                    Background="#FF6B6B" Foreground="White" Padding="10,8" FontWeight="Bold" Cursor="Hand" IsEnabled="False" Style="{StaticResource HoverButtonStyle}"/>
                            <TextBlock Text="ðŸ“º Live Activity Stream" VerticalAlignment="Center" Foreground="#00D9FF" FontWeight="Bold" FontSize="13"/>
                        </StackPanel>
                    </Border>

                    <!-- Current Session Statistics Panel -->
                    <Border Grid.Row="1" Background="#0F1419" BorderBrush="#00D9FF" BorderThickness="0,0,0,1" Padding="15" Margin="10,10,10,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Tracking Since Info (spans all columns) -->
                            <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="4" Name="TrackingSinceTextBlock" 
                                       Text="â²ï¸ Tracking since: [Not connected]" 
                                       Foreground="#FFB700" FontSize="12" Margin="0,0,0,10"/>
                            
                            <!-- Current App Time -->
                            <Border Grid.Row="1" Grid.Column="0" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="1" CornerRadius="4" Padding="12" Margin="0,0,10,0">
                                <StackPanel Orientation="Vertical">
                                    <TextBlock Text="â±ï¸ Current App Time" Foreground="#00D9FF" FontWeight="Bold" FontSize="11"/>
                                    <TextBlock Name="CurrentSessionTimeTextBlock" Text="None" Foreground="#00FF00" FontWeight="Bold" FontSize="14" Margin="0,5,0,0"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Apps This Session -->
                            <Border Grid.Row="1" Grid.Column="1" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="1" CornerRadius="4" Padding="12" Margin="0,0,10,0">
                                <StackPanel Orientation="Vertical">
                                    <TextBlock Text="ðŸ“± Apps This Session" Foreground="#00D9FF" FontWeight="Bold" FontSize="11"/>
                                    <TextBlock Name="CurrentSessionAppsTextBlock" Text="0" Foreground="#00BFFF" FontWeight="Bold" FontSize="16" Margin="0,5,0,0"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Session Duration -->
                            <Border Grid.Row="1" Grid.Column="2" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="1" CornerRadius="4" Padding="12" Margin="0,0,10,0">
                                <StackPanel Orientation="Vertical">
                                    <TextBlock Text="â³ Session Duration" Foreground="#00D9FF" FontWeight="Bold" FontSize="11"/>
                                    <TextBlock Name="CurrentSessionDurationTextBlock" Text="00:00:00" Foreground="#FFD700" FontWeight="Bold" FontSize="16" Margin="0,5,0,0"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Connection Status -->
                            <Border Grid.Row="1" Grid.Column="3" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="1" CornerRadius="4" Padding="12">
                                <StackPanel Orientation="Vertical">
                                    <TextBlock Text="ðŸŸ¢ Status" Foreground="#00D9FF" FontWeight="Bold" FontSize="11"/>
                                    <TextBlock Name="CurrentSessionStatusTextBlock" Text="Disconnected" Foreground="#FF6B6B" FontWeight="Bold" FontSize="14" Margin="0,5,0,0"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Border>

                    <Border Grid.Row="2" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="1" Margin="10" CornerRadius="4">
                        <ListBox Name="ActivityListBox" Background="#1A2A3A" BorderThickness="0" ScrollViewer.VerticalScrollBarVisibility="Auto" Foreground="#E8EAED">
                            <ListBox.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="ï¿½ Manage Activity Sessions" Click="CustomizeMessages_Click"/>
                                    <Separator/>
                                    <MenuItem Header="Clear Selected" Click="ClearSelected_Click"/>
                                </ContextMenu>
                            </ListBox.ContextMenu>
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#1A2A3A" BorderBrush="#2A4A5A" BorderThickness="0,0,0,1" Padding="12">
                                        <TextBlock Text="{Binding}" Foreground="#A0BCD4" TextWrapping="Wrap" FontSize="11" LineHeight="16"/>
                                    </Border>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                            <ListBox.Style>
                                <Style TargetType="ListBox">
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#242F3F"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </ListBox.Style>
                        </ListBox>
                    </Border>

                    <Border Grid.Row="3" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="0,1,0,0" Padding="15" CornerRadius="0,0,4,4">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Button Name="ClearButton" Content="ðŸ—‘ï¸ Clear Activity" Width="140" Margin="0,0,10,0" Click="ClearButton_Click" 
                                    Background="#FF8C42" Foreground="White" Padding="10,8" FontWeight="Bold" Cursor="Hand" Style="{StaticResource HoverButtonStyle}"/>
                            <DatePicker Name="ExportDatePicker" Width="140" Margin="0,0,10,0" SelectedDate="{x:Static sys:DateTime.Today}"/>
                            <Button Name="ExportActivityButton" Content="ðŸ“Š Export Data" Width="130" Margin="0,0,10,0" Click="ExportActivityButton_Click" 
                                    Background="#00D9FF" Foreground="#0F1419" Padding="10,8" FontWeight="Bold" Cursor="Hand" Style="{StaticResource HoverButtonStyle}"/>
                            <Button Name="ResetDataButton" Content="âš ï¸ Reset All Data" Width="140" Margin="0,0,0,0" 
                                    Background="#FF4444" Foreground="White" Padding="10,8" FontWeight="Bold" Cursor="Hand" ToolTip="WARNING: Deletes ALL data permanently!"
                                    Style="{StaticResource HoverButtonStyle}"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- History Tab -->
            <TabItem Header="App Usage History" Padding="10,5" Foreground="#E8EAED">
                <Grid Background="#0F1419">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="0,0,0,1" Padding="15">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="Running Applications" FontWeight="Bold" FontSize="14" Foreground="#00D9FF"/>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="1" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="1" Margin="10" CornerRadius="4">
                        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                            <DataGrid Name="RunningAppsDataGrid"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserSortColumns="False"
                                      CanUserReorderColumns="False"
                                      Background="#1A2A3A"
                                      BorderThickness="0"
                                      IsReadOnly="True"
                                      HeadersVisibility="Column"
                                      GridLinesVisibility="All"
                                      ColumnHeaderHeight="40"
                                      RowHeight="35"
                                      AlternatingRowBackground="#242F3F"
                                      FontSize="12"
                                      SelectionMode="Single"
                                      RowStyle="{StaticResource DataGridRowStyle}"
                                      Foreground="#E8EAED">
                                <DataGrid.Resources>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="Background" Value="#2A3A4A"/>
                                        <Setter Property="Foreground" Value="#00D9FF"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Padding" Value="8,5,8,5"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                                        <Setter Property="BorderBrush" Value="#00D9FF"/>
                                        <Setter Property="BorderThickness" Value="1"/>
                                    </Style>
                                </DataGrid.Resources>
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Application" Binding="{Binding AppName}" Width="Auto" MinWidth="200" FontWeight="SemiBold" Foreground="#E8EAED">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextAlignment" Value="Left"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="Padding" Value="8,0,8,0"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="Total Time" Binding="{Binding TotalTime}" Width="120" FontWeight="Bold" Foreground="#00D9FF">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextAlignment" Value="Center"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="Sessions" Binding="{Binding SessionCount}" Width="100" FontWeight="SemiBold" Foreground="#00BCD4">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextAlignment" Value="Center"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="Times Opened" Binding="{Binding TimesOpened}" Width="120" FontWeight="SemiBold" Foreground="#FF9800">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextAlignment" Value="Center"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="110" FontWeight="Bold" Foreground="#4CAF50">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="TextAlignment" Value="Center"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </ScrollViewer>
                    </Border>

                    <Border Grid.Row="2" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="0,1,0,0" Padding="15" CornerRadius="0,0,4,4">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Name="RunningAppsRefreshTextBlock" Text="Auto-refreshing..." VerticalAlignment="Center" 
                                       Foreground="#A0A0A0" FontSize="11" Margin="0,0,0,0"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Daily Summary Tab -->
            <TabItem Header="Daily Summary" Padding="10,5" Foreground="#E8EAED">
                <Grid Background="#0F1419">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="0,0,0,1" Padding="15">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="Daily Application Usage Summary" FontWeight="Bold" FontSize="14" Foreground="#00D9FF" Margin="0,0,15,0"/>
                            <DatePicker Name="HistoryDatePicker" Width="150" Margin="0,0,0,0" SelectedDateChanged="HistoryDatePicker_SelectedDateChanged"/>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="1" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="1" Margin="10" CornerRadius="4">
                        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                            <DataGrid Name="HistoryDataGrid"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserSortColumns="False"
                                      CanUserReorderColumns="False"
                                      Background="#1A2A3A"
                                      BorderThickness="0"
                                      IsReadOnly="True"
                                      HeadersVisibility="Column"
                                      GridLinesVisibility="Horizontal"
                                      ColumnHeaderHeight="35"
                                      RowHeight="32"
                                      AlternatingRowBackground="#242F3F"
                                      HorizontalScrollBarVisibility="Auto"
                                      VerticalScrollBarVisibility="Auto"
                                      FontSize="12"
                                      RowStyle="{StaticResource DataGridRowStyle}"
                                      Foreground="#E8EAED"
                                      MouseLeftButtonUp="HistoryDataGrid_ColumnHeaderMouseClick">
                                <DataGrid.Resources>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="Background" Value="#2A3A4A"/>
                                        <Setter Property="Foreground" Value="#00D9FF"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Padding" Value="10"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                        <Setter Property="BorderBrush" Value="#00D9FF"/>
                                        <Setter Property="BorderThickness" Value="0,0,1,0"/>
                                    </Style>
                                </DataGrid.Resources>
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ðŸ“± Application" Binding="{Binding AppName}" Width="180" FontWeight="SemiBold" Foreground="#E8EAED"/>
                                    <DataGridTextColumn Header="â±ï¸ Total Time" Binding="{Binding TotalTime}" Width="120" Foreground="#00D9FF" FontWeight="Bold">
                                        <DataGridTextColumn.CellStyle>
                                            <Style TargetType="DataGridCell">
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.CellStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="ðŸ“Š Sessions" Binding="{Binding SessionCount}" Width="80" Foreground="#00BCD4" FontWeight="SemiBold">
                                        <DataGridTextColumn.CellStyle>
                                            <Style TargetType="DataGridCell">
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.CellStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="â° First Use" Binding="{Binding FirstUse, StringFormat='MM/dd/yyyy HH:mm'}" Width="150" Foreground="#A0BCD4">
                                        <DataGridTextColumn.CellStyle>
                                            <Style TargetType="DataGridCell">
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.CellStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="â° Last Use" Binding="{Binding LastUse, StringFormat='MM/dd/yyyy HH:mm'}" Width="150" Foreground="#A0BCD4">
                                        <DataGridTextColumn.CellStyle>
                                            <Style TargetType="DataGridCell">
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.CellStyle>
                                    </DataGridTextColumn>
                                    <DataGridTemplateColumn Header="ðŸ”´ Status" Width="110">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                                    <Border Padding="8,4" CornerRadius="3">
                                                        <Border.Style>
                                                            <Style TargetType="Border">
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Status}" Value="Running">
                                                                        <Setter Property="Background" Value="#00D9FF"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Status}" Value="Background">
                                                                        <Setter Property="Background" Value="#FF8C42"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Status}" Value="Idle">
                                                                        <Setter Property="Background" Value="#00BCD4"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Status}" Value="Stopped">
                                                                        <Setter Property="Background" Value="#FF6B6B"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Border.Style>
                                                        <TextBlock Text="{Binding Status}" TextAlignment="Center" FontWeight="SemiBold" Foreground="#0F1419" FontSize="11"/>
                                                    </Border>
                                                </Grid>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </ScrollViewer>
                    </Border>

                    <Border Grid.Row="2" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="0,1,0,0" Padding="15" CornerRadius="0,0,4,4">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Name="LastRefreshTextBlock" Text="Auto-refreshing..." VerticalAlignment="Center" 
                                       Foreground="#A0A0A0" FontSize="11" Margin="0,0,15,0"/>
                            <Button Name="ExportSessionButton" Content="ðŸ“Š Export Session" Style="{StaticResource HoverButtonStyle}" 
                                    Click="ExportSessionButton_Click" Margin="0,0,10,0" Padding="12,8" FontSize="12"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- App Usage Charts Tab -->
            <TabItem Header="ðŸ“Š App Usage Charts" Padding="10,5" Foreground="#E8EAED">
                <Grid Background="#0F1419">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="0,0,0,1" Padding="15">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="Application Usage Visualization" FontWeight="Bold" FontSize="14" Foreground="#00D9FF" Margin="0,0,20,0"/>
                            <TextBlock Text="Top apps by total time spent today" FontSize="12" Foreground="#A0A0A0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="1" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="1" Margin="10" CornerRadius="4" Padding="15">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="1*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Chart Container (Column Chart) -->
                            <Border Grid.Column="0" Background="#0F1419" BorderBrush="#00D9FF" BorderThickness="1" CornerRadius="4" Padding="10">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    
                                    <TextBlock Grid.Row="0" Text="Time Spent per Application (Column Chart)" FontWeight="Bold" FontSize="12" Foreground="#00D9FF" Margin="0,0,0,10"/>
                                    <Canvas Grid.Row="1" Name="AppUsageChartCanvas" Background="#0F1419" MinHeight="300" MinWidth="400"/>
                                </Grid>
                            </Border>

                            <!-- Stats Panel -->
                            <Border Grid.Column="2" Background="#0F1419" BorderBrush="#00D9FF" BorderThickness="1" CornerRadius="4" Padding="15">
                                <ScrollViewer VerticalScrollBarVisibility="Auto">
                                    <StackPanel>
                                        <TextBlock Text="Today's Summary" FontWeight="Bold" FontSize="13" Foreground="#00D9FF" Margin="0,0,0,15"/>

                                        <!-- Highest Usage -->
                                        <Border Background="#1A3A2A" BorderBrush="#4CAF50" BorderThickness="1" CornerRadius="4" Padding="10" Margin="0,0,0,10">
                                            <StackPanel>
                                                <TextBlock Text="ðŸ† Most Used App" FontWeight="Bold" FontSize="11" Foreground="#4CAF50"/>
                                                <TextBlock Name="HighestUsageAppName" Text="N/A" FontSize="13" FontWeight="Bold" Foreground="#E8EAED" Margin="0,5,0,0"/>
                                                <TextBlock Name="HighestUsageTime" Text="0h 0m 0s" FontSize="12" Foreground="#A0A0A0"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- Lowest Usage -->
                                        <Border Background="#3A2A1A" BorderBrush="#FF9800" BorderThickness="1" CornerRadius="4" Padding="10" Margin="0,0,0,10">
                                            <StackPanel>
                                                <TextBlock Text="ðŸ“‰ Least Used App" FontWeight="Bold" FontSize="11" Foreground="#FF9800"/>
                                                <TextBlock Name="LowestUsageAppName" Text="N/A" FontSize="13" FontWeight="Bold" Foreground="#E8EAED" Margin="0,5,0,0"/>
                                                <TextBlock Name="LowestUsageTime" Text="0h 0m 0s" FontSize="12" Foreground="#A0A0A0"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- Total Apps -->
                                        <Border Background="#1A2A3A" BorderBrush="#00BCD4" BorderThickness="1" CornerRadius="4" Padding="10" Margin="0,0,0,10">
                                            <StackPanel>
                                                <TextBlock Text="ðŸ“± Total Apps Used" FontWeight="Bold" FontSize="11" Foreground="#00BCD4"/>
                                                <TextBlock Name="TotalAppsCount" Text="0" FontSize="16" FontWeight="Bold" Foreground="#E8EAED" Margin="0,5,0,0"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- Total Screen Time -->
                                        <Border Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="1" CornerRadius="4" Padding="10">
                                            <StackPanel>
                                                <TextBlock Text="â±ï¸ Total Screen Time" FontWeight="Bold" FontSize="11" Foreground="#00D9FF"/>
                                                <TextBlock Name="TotalScreenTime" Text="0h 0m 0s" FontSize="16" FontWeight="Bold" Foreground="#E8EAED" Margin="0,5,0,0"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </ScrollViewer>
                            </Border>
                        </Grid>
                    </Border>

                    <Border Grid.Row="2" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="0,1,0,0" Padding="15" CornerRadius="0,0,4,4">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Name="ChartRefreshTextBlock" Text="Auto-refreshing..." VerticalAlignment="Center" 
                                       Foreground="#A0A0A0" FontSize="11" Margin="0,0,15,0"/>
                            <Button Name="RefreshChartButton" Content="ðŸ”„ Refresh Chart" Style="{StaticResource HoverButtonStyle}" 
                                    Click="RefreshChartButton_Click" Margin="0,0,10,0" Padding="12,8" FontSize="12"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- System Stats Tab -->
            <TabItem Header="System Stats" Padding="10,5" Foreground="#E8EAED">
                <Grid Background="#0F1419" Margin="15">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="1*"/>
                        <RowDefinition Height="1*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Text="System Performance Metrics" FontWeight="Bold" FontSize="16" Margin="0,0,0,15" Foreground="#00D9FF"/>
                    
                    <!-- Top Row: CPU (Left) and GPU (Right) -->
                    <Grid Grid.Row="1" Margin="0,0,0,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="1*"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="1*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- CPU Item -->
                        <Border Grid.Column="0" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="1" CornerRadius="4" Padding="15">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="CPU Usage" FontWeight="Bold" FontSize="13" Foreground="#00D9FF"/>
                                    <TextBlock Name="CpuNameTextBlock" Text="CPU: N/A" Foreground="#A0A0A0" FontSize="11" Grid.Column="1" Margin="15,0,0,0"/>
                                    <TextBlock Name="CpuStatsTextBlock" Text="N/A" Foreground="#00D9FF" FontSize="16" FontWeight="Bold" Grid.Column="2"/>
                                </Grid>
                                <Canvas Grid.Row="1" Name="CpuGraphCanvas" Background="#0F1419" Margin="0,10,0,0" SizeChanged="GraphCanvas_SizeChanged">
                                    <Rectangle Fill="#1A3A4A" Stroke="#003D4D" StrokeThickness="0.5"/>
                                    <Polyline Name="CpuGraphPolyline" Stroke="#00D9FF" StrokeThickness="2" Points=""/>
                                </Canvas>
                            </Grid>
                        </Border>
                        
                        <!-- GPU Item -->
                        <Border Grid.Column="2" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="1" CornerRadius="4" Padding="15">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="GPU Usage" FontWeight="Bold" FontSize="13" Foreground="#00D9FF"/>
                                    <StackPanel Grid.Column="1" Margin="15,0,0,0">
                                        <TextBlock Name="GpuNameTextBlock" Text="GPU: N/A" Foreground="#A0A0A0" FontSize="11"/>
                                        <ComboBox Name="GpuSelectionComboBox" Margin="0,5,0,0" SelectionChanged="GpuSelectionComboBox_SelectionChanged" MaxHeight="23"/>
                                    </StackPanel>
                                    <TextBlock Name="GpuStatsTextBlock" Text="N/A" Foreground="#00D9FF" FontSize="16" FontWeight="Bold" Grid.Column="2"/>
                                </Grid>
                                <Canvas Grid.Row="1" Name="GpuGraphCanvas" Background="#0F1419" Margin="0,10,0,0" SizeChanged="GraphCanvas_SizeChanged">
                                    <Rectangle Fill="#1A3A4A" Stroke="#003D4D" StrokeThickness="0.5"/>
                                    <Polyline Name="GpuGraphPolyline" Stroke="#00D9FF" StrokeThickness="2" Points=""/>
                                </Canvas>
                            </Grid>
                        </Border>
                    </Grid>
                    
                    <!-- Bottom Row: Memory (Left) and Disk (Right) -->
                    <Grid Grid.Row="2" Margin="0,0,0,15">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="1*"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="1*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Memory Item -->
                        <Border Grid.Column="0" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="1" CornerRadius="4" Padding="15">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Memory Usage" FontWeight="Bold" FontSize="13" Foreground="#00D9FF"/>
                                    <TextBlock Name="MemoryNameTextBlock" Text="RAM: N/A" Foreground="#A0A0A0" FontSize="11" Grid.Column="1" Margin="15,0,0,0"/>
                                    <TextBlock Name="MemoryStatsTextBlock" Text="N/A" Foreground="#00D9FF" FontSize="16" FontWeight="Bold" Grid.Column="2"/>
                                </Grid>
                                <Canvas Grid.Row="1" Name="MemoryGraphCanvas" Background="#0F1419" Margin="0,10,0,0" SizeChanged="GraphCanvas_SizeChanged">
                                    <Rectangle Fill="#1A3A4A" Stroke="#003D4D" StrokeThickness="0.5"/>
                                    <Polyline Name="MemoryGraphPolyline" Stroke="#00D9FF" StrokeThickness="2" Points=""/>
                                </Canvas>
                            </Grid>
                        </Border>
                        
                        <!-- Disk Item -->
                        <Border Grid.Column="2" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="1" CornerRadius="4" Padding="15">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Grid Grid.Row="0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="100"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Disk Usage" FontWeight="Bold" FontSize="13" Foreground="#00D9FF"/>
                                    <StackPanel Grid.Column="1" Margin="15,0,0,0">
                                        <TextBlock Name="DiskNameTextBlock" Text="Storage: N/A" Foreground="#A0A0A0" FontSize="11"/>
                                        <ComboBox Name="DiskSelectionComboBox" Margin="0,5,0,0" SelectionChanged="DiskSelectionComboBox_SelectionChanged" MaxHeight="23"/>
                                    </StackPanel>
                                    <TextBlock Name="DiskUsageTextBlock" Text="N/A" Foreground="#00D9FF" FontSize="16" FontWeight="Bold" Grid.Column="2"/>
                                </Grid>
                                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,5,0,0">
                                    <TextBlock Name="DiskStatsTextBlock" Text="Active: N/A" Foreground="#A0A0A0" FontSize="10" Margin="0,0,15,0"/>
                                    <TextBlock Name="DiskResponseTextBlock" Text="Response: N/A" Foreground="#A0A0A0" FontSize="10"/>
                                </StackPanel>
                                <Canvas Grid.Row="2" Name="DiskGraphCanvas" Background="#0F1419" Margin="0,10,0,0" SizeChanged="GraphCanvas_SizeChanged">
                                    <Rectangle Fill="#1A3A4A" Stroke="#003D4D" StrokeThickness="0.5"/>
                                    <Polyline Name="DiskGraphPolyline" Stroke="#00D9FF" StrokeThickness="2" Points=""/>
                                </Canvas>
                            </Grid>
                        </Border>
                    </Grid>
                    
                    <!-- System Uptime -->
                    <Border Grid.Row="3" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="1" CornerRadius="4" Padding="15">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="System Uptime" FontWeight="Bold" FontSize="13" Foreground="#00D9FF"/>
                            <TextBlock Name="UptimeDescriptionTextBlock" Text="Time since last restart" Foreground="#A0A0A0" FontSize="11" Grid.Column="1" Margin="15,0,0,0" VerticalAlignment="Center"/>
                            <TextBlock Name="UptimeTextBlock" Text="N/A" Foreground="#00D9FF" FontSize="16" FontWeight="Bold" Grid.Column="2"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- Footer -->
        <Border Grid.Row="2" Background="#1A2A3A" BorderBrush="#00D9FF" BorderThickness="0,1,0,0" Padding="10" Height="40">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                <CheckBox Name="AutostartCheckBox" Content="Start with Windows" Margin="0,0,10,0" VerticalAlignment="Center" Foreground="#E8EAED"/>
                <CheckBox Name="MinimizeToTrayCheckBox" Content="Minimize to tray" Margin="0,0,10,0" VerticalAlignment="Center" Foreground="#E8EAED"/>
                <TextBlock Name="FooterTextBlock" Text="Ready" VerticalAlignment="Center" Foreground="#00D9FF" FontWeight="SemiBold"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
